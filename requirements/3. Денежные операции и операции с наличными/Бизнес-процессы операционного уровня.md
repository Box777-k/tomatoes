# Бизнес-процессы операционного уровня - Финансы

Операционный уровень отвечает за фиксацию движения денежных средств и контроль остатков по счетам.

| Номер | Название бизнес-процесса | Краткое описание |
|-------|--------------------------|------------------|
| ОП-3.1 | Регистрация поступления денежных средств | Пользователь фиксирует поступление денег на операционный счёт с указанием суммы, даты и назначения платежа. Операция увеличивает остаток денежных средств на счёте. Поступление может быть с внешнего источника или переводом с другого счёта организации. Система автоматически рассчитывает текущий остаток. |
| ОП-3.2 | Регистрация расхода денежных средств | Пользователь отражает списание денег с операционного счёта с указанием суммы, даты, обязательной категории расхода и описания транзакции (назначение платежа может быть пустым). Операция уменьшает остаток на счёте. Система проверяет достаточность средств перед списанием. Расход может быть на внешнего получателя или переводом на другой счёт организации. |
| ОП-3.3 | Перемещение денег между счетами | Пользователь переводит деньги между счетами организации. Система создаёт две связанные операции: списание со счёта-источника и зачисление на счёт-получатель. Контролируется достаточность средств на счёте-источнике. Операции связаны между собой для отслеживания парных движений. Для операций перемещения автоматически используется системная категория "Перемещение между счетами" (создается в data-seed). |
| ОП-3.4 | Отмена операции движения денег | Пользователь отменяет ранее созданную операцию движения денег. Операция меняет статус на "отменена" без физического удаления записи. При отмене пересчитываются остатки по счетам. Если операция является частью перемещения между счетами, отменяются обе парные операции. История изменений сохраняется. |
| ОП-3.5 | Создание операционного счёта | Пользователь создаёт новый счёт для учёта денежных средств с указанием названия, типа (наличный/безналичный), валюты и начального остатка. Счёт может иметь дополнительные атрибуты: номер счёта, визуальное оформление, позицию сортировки. После создания счёт доступен для операций движения денег. |
| ОП-3.6 | Редактирование операционного счёта | Пользователь изменяет параметры существующего счёта: название, визуальное оформление, порядок сортировки. Изменение типа счёта и валюты запрещено при наличии операций. Начальный остаток можно корректировать только если нет операций или через специальную корректирующую операцию. |
| ОП-3.7 | Деактивация операционного счёта | Пользователь закрывает счёт, делая его недоступным для новых операций. Деактивированный счёт не удаляется из системы, сохраняется вся история операций. Деактивация возможна только при нулевом остатке или с принудительным переносом остатка на другой счёт. Деактивированные счета не отображаются в списках активных счетов. |
| ОП-3.8 | Просмотр баланса счёта | Пользователь просматривает текущий остаток денежных средств на конкретном счёте. Система рассчитывает баланс как начальный остаток плюс сумма всех активных операций. Баланс можно запросить на текущую дату или на любую дату в прошлом. Отображается валюта счёта и дата последней операции. Для деактивированных счетов баланс рассчитывается только до даты деактивации, новые операции не учитываются. |
| ОП-3.9 | Просмотр истории операций по счёту | Пользователь просматривает список всех операций по конкретному счёту за выбранный период. Список включает дату, тип операции, сумму, остаток после операции, назначение платежа, категорию. Поддерживается фильтрация по типу операций, категориям, диапазону сумм, статусу. Отменённые операции отображаются отдельно или скрываются. Деактивированные счета остаются доступными для просмотра истории, но не для создания новых операций. |
| ОП-3.10 | Просмотр всех активных счетов | Пользователь просматривает сводный список всех активных счетов организации. Для каждого счёта отображается название, тип, валюта, текущий остаток. Счета группируются по типам и сортируются согласно заданному порядку. Поддерживается фильтрация по типу счёта и валюте. |
| ОП-3.11 | Экспорт выписки по счёту [НЕ РАЗРАБАТЫВАТЬ] | Пользователь формирует выгрузку операций по счёту за указанный период. Выписка содержит дату, тип операции, сумму, назначение платежа, остаток. Поддерживаются форматы экспорта: CSV, Excel, PDF. Выписка может использоваться для сверки с банковскими данными или для передачи в бухгалтерию. Функционал отложен для отдельной реализации. |
| ОП-3.12 | Управление категориями операций | Пользователь создаёт и редактирует справочник категорий для классификации операций движения денег. Категории организованы в иерархическое дерево с поддержкой неограниченной вложенности. Каждая категория имеет название, описание, родительскую категорию (nullable для корневых), визуальное оформление (цвет, иконка), признак активности, позицию сортировки. Системные категории (например "Перемещение между счетами") не могут быть удалены или деактивированы. Категории используются для группировки операций в отчётах и управленческой аналитике. При удалении категории проверяется отсутствие связанных операций.|

## Особенности операционного уровня

- Операции фиксируют фактическое движение денег
- Остатки рассчитываются в реальном времени
- Операции не удаляются, только отменяются со сменой статуса
- Данные операционного уровня используются для генерации бухгалтерских проводок
- Нет привязки к контрагентам и первичным документам (это уровень бухгалтерии)
- Категории операций используются для управленческого учёта, не для бухгалтерских проводок
